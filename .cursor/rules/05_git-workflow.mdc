---
description: コミットと PR の作成手順・ベストプラクティス。コミット/PR 作成時に参照する。
alwaysApply: false
---

# Git ワークフロー

コミットとプルリクエストの作成に関するベストプラクティスに従う。

## コミットの作成

1. **変更の確認**
   ```bash
   git status
   git diff
   git log
   ```

2. **変更の分析**
   - 変更または追加されたファイルの特定
   - 変更の性質（新機能、バグ修正、リファクタリングなど）の把握
   - プロジェクトへの影響評価
   - 機密情報の有無確認

3. **コミットメッセージの作成**
   - 「なぜ」に焦点を当てる
   - 明確で簡潔な言葉を使用
   - 変更の目的を正確に反映
   - 一般的な表現を避ける

4. **コミットの実行**
   ```bash
   git add <files>
   git commit -m "$(cat <<'EOF'
   feat: ユーザー認証にResult型を導入

   - エラー処理をより型安全に
   - エラーケースの明示的な処理を強制
   - テストの改善

   🤖 ${K4}で生成
   Co-Authored-By: Claude noreply@anthropic.com
   EOF
   )"
   ```
   - `${K4}` は環境に合わせて差し替え可能なプレースホルダー（モデル名など）。

## プルリクエストの作成

1. **ブランチの状態確認**
   ```bash
   git status
   git diff
   git diff main...HEAD
   git log
   ```

2. **変更の分析**
   - main から分岐後のすべてのコミットの確認
   - 変更の性質と目的の把握
   - プロジェクトへの影響評価
   - 機密情報の有無確認

3. **プルリクエストの作成**
   ```bash
   gh pr create --title "feat: Result型によるエラー処理の改善" --body "$(cat <<'EOF'
   ## 概要

   エラー処理をより型安全にするため、Result型を導入しました。

   ## 変更内容

   - neverthrowを使用したResult型の導入
   - エラーケースの明示的な型定義
   - テストケースの追加

   ## レビューのポイント

   - Result型の使用方法が適切か
   - エラーケースの網羅性
   - テストの十分性
   EOF
   )"
   ```

## 重要な注意事項

### コミット関連
- 可能な場合は `git commit -am` を使用
- 関係ないファイルは含めない
- 空のコミットは作成しない
- git 設定は変更しない

### プルリクエスト関連
- 必要に応じて新しいブランチを作成
- 変更を適切にコミット
- リモートへのプッシュは `-u` フラグを使用
- すべての変更を分析

### 避けるべき操作
- 対話的な git コマンド（`-i` フラグ）の使用
- リモートリポジトリへの直接プッシュ
- git 設定の変更

## コミットメッセージの例

- 新機能: `feat: Result型によるエラー処理の導入`
- 既存機能の改善: `update: キャッシュ機能のパフォーマンス改善`
- バグ修正: `fix: 認証トークンの期限切れ処理を修正`
- リファクタリング: `refactor: Adapterパターンを使用して外部依存を抽象化`
- テスト追加: `test: Result型のエラーケースのテストを追加`
- ドキュメント: `docs: エラー処理のベストプラクティスを追加`

## プルリクエストの例

```markdown
## 概要

TypeScriptのエラー処理をより型安全にするため、Result型を導入しました。

## 変更内容

- neverthrowライブラリの導入
- APIクライアントでのResult型の使用
- エラーケースの型定義
- テストケースの追加

## 技術的な詳細

- 既存の例外処理をResult型に置き換え
- エラー型の共通化
- モック実装の改善

## レビューのポイント

- Result型の使用方法が適切か
- エラーケースの網羅性
- テストの十分性
```
